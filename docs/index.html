<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate Starting Trees For Combined Molecular, Morphological and Stratigraphic Data • treestartr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Generate Starting Trees For Combined Molecular, Morphological and Stratigraphic Data">
<meta property="og:description" content="Combine a list of taxa with a phylogeny to generate a starting tree for use in
    total evidence dating analyses.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">treestartr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<p><img src="images/logo1.png" alt="logo"><a href="https://travis-ci.org/wrightaprilm/treeStartR"><img src="https://travis-ci.org/wrightaprilm/treeStartR.svg?branch=master" alt="Build Status"></a> <a href="https://codecov.io/gh/wrightaprilm/treeStartR"><img src="https://codecov.io/gh/wrightaprilm/treeStartR/branch/master/graph/badge.svg" alt="codecov"></a></p>
<div id="treestartr" class="section level2">
<h2 class="hasAnchor">
<a href="#treestartr" class="anchor"></a>treeStartR</h2>
<p>Phylogenetic trees, and particularly time-scaled phylogenetic trees, are increasingly estimated using complex models of evolution. Finding a starting tree with a computable likelihood to perform a Bayesian MCMC can be a challenge, particularly when when estimation involves taxa, large datasets, many parameters, and missing data.</p>
<p>The purpose of this package is to allow users to efficiently add taxa to a given tree to generate a reasonable starting tree. While adding tips to a tree may be trivial if all tips have the same datatype (i.e., nucleotide sequence data), this can be more challenging for mixed datatype analyses. Additionally, taxa for which only stratiraphic data are available cannot have phylogenetic placements estimated, and must be placed via expert knowledge.</p>
<p>This package allows users to input a known phylogeny, and add tips to the tree. Tips can either be added via a pop-up prompt, in which users specify the exact node which the tip will subtend, or at random, or by providing a taxon set with which the tip should form a group.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the development version directly from Github</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"wrightaprilm/treeStartR"</span>)</a></code></pre></div>
<pre><code>## Skipping install of 'treestartr' from a github remote, the SHA1 (5e619d08) has not changed since last install.
##   Use `force = TRUE` to force installation</code></pre>
</div>
<div id="dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#dependencies" class="anchor"></a>Dependencies</h2>
<p>treeStartR depends on phytools.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(phytools)</a></code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<pre><code>## Loading required package: maps</code></pre>
</div>
<div id="usage-example" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-example" class="anchor"></a>Usage Example</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(treestartr)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">data</span>(bears)</a></code></pre></div>
<p>First, we need to load a list of the total set of taxa present in the tree. The “total set” refers to any taxa that will be included in your analysis. This can be either a CSV or a TSV file. A sample list, tax_list, has been provided as part of the bears data object, but you can also generate one using the function dataf_parser.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">tax_list &lt;-<span class="st"> </span><span class="kw"><a href="reference/dataf_parsr.html">dataf_parsr</a></span>(path<span class="op">/</span>to<span class="op">/</span>tax_file)</a></code></pre></div>
<p>Next, we find out which of the taxa from our total set are not represented on the tree already. This function takes as input a tree, with or without branch lengths, but without annotations (such as 95% HPDs). It also takes the total set of taxa generated by dataf_parser:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">absent_list &lt;-<span class="st"> </span><span class="kw"><a href="reference/genera_strippr.html">genera_strippr</a></span>(tree, tax_list)</a></code></pre></div>
<pre><code>## [1] "Ailurarctos_lufengensis" "Indarctos_punjabiensis" 
## [3] "Kretzoiarctos_beatrix"   "Parictis_montanus"      
## [5] "Ursavus_brevirhinus"     "Ursavus_primaevus"      
## [7] "Ursus_abstrusus"</code></pre>
</div>
<div id="adding-tips-with-congeners" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-tips-with-congeners" class="anchor"></a>Adding tips with congeners</h2>
<p>Finally, we add the tips that are not present to the tree. If there are other representatives of the same genera as an absent taxon (for example, adding an additonal “Ursus” species to the example tree), those taxa will be used to place the tip. If there are multiple species of the genera, the new tip will subtend the most recent common ancestor of the tips already on the tree. If there is only one representative, the tip will subtend the parent node of that taxon.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">new_tree &lt;-<span class="st"> </span><span class="kw"><a href="reference/present_tippr.html">present_tippr</a></span>(tree, absent_list)</a></code></pre></div>
<pre><code>## [1] "Adding tips with congeners on tree:"
## [1] "Indarctos_punjabiensis"</code></pre>
<pre><code>## Warning in bind.tree(tree, tip, where = where, position = pp): one tree has
## no branch lengths, they have been ignored</code></pre>
<pre><code>## [1] "Adding tips with congeners on tree:"
## [1] "Ursus_abstrusus"</code></pre>
</div>
<div id="adding-tips-manually" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-tips-manually" class="anchor"></a>Adding tips manually</h2>
<p>We can also add the tips that have no congeners. This function will ask for input. A pop-up will be produced, showing node labels. When the program asks for input, you will tell it what node you would like the tip to subtend:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">new_tree &lt;-<span class="st"> </span><span class="kw">absent_tippR</span>(tree, absent_list)</a></code></pre></div>
</div>
<div id="adding-tips-at-random" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-tips-at-random" class="anchor"></a>Adding tips at random</h2>
<p>Or, if there are no congeners, you may choose to add tips at random:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">new_tree &lt;-<span class="st"> </span><span class="kw"><a href="reference/rand_absent_tippr.html">rand_absent_tippr</a></span>(tree, absent_list)</a></code></pre></div>
<pre><code>## [1] "Ailurarctos"
## [1] "Indarctos"
## [1] "Kretzoiarctos"
## [1] "Parictis"
## [1] "Ursavus"
## [1] "Ursavus"
## [1] "Ursus"</code></pre>
<pre><code>## Warning in bind.tree(tree, tip, where = where, position = pp): one tree has
## no branch lengths, they have been ignored</code></pre>
</div>
<div id="adding-tips-via-csv" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-tips-via-csv" class="anchor"></a>Adding tips via CSV</h2>
<p>Lastly, you may have a TSV file that specifies the tips to be added, and a taxon set. treeStartR will locate the MRCA of the taxon set, and add the tips subtending that node.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">new_tree &lt;-<span class="st"> </span><span class="kw"><a href="reference/text_placr.html">text_placr</a></span>(tree, mrca_df)</a></code></pre></div>
<pre><code>## [1] "Placing taxon via provided input: Kretzoiarctos_beatrix"
## [1] "Placing tip at node 25"</code></pre>
<pre><code>## Warning in bind.tree(tree, tip, where = where, position = pp): one tree has
## no branch lengths, they have been ignored</code></pre>
<pre><code>## [1] "Placing taxon via provided input: Ursus_abstrusus"
## [1] "Placing tip at node 30"</code></pre>
</div>
<div id="outputting-results" class="section level2">
<h2 class="hasAnchor">
<a href="#outputting-results" class="anchor"></a>Outputting results</h2>
<p>The final tree can be output using standard functions in ape, such as write.nexus():</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">write.nexus</span>(new_tree, <span class="dt">file =</span> <span class="st">"data/export_example.tre"</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="NA">NA</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>April Wright <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by April Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
